CONST
QE_LEN=34;
BLANK=''(0,0,0,0,0,0);
TYPE
RELATIONTYPE=(DEPENDENT,INDEPENDENT);
UNIVERSAL=[UNSAFE]INTEGER;
BYTE_RANGE=0..255;
PRIORITY_RANGE=0..255;
VAL_DATA_LEN=0..QE_LEN;
REF_DATA_LEN=0..8128;
RING_BUFFER_DATA=0..8128;
RING_BUFFER_SIZE=8..8128;
NAME_STR=PACKED ARRAY[1..6]OF CHAR;
BIN_SEM_VAL=0..1;
QUAD_WORD=RECORD
ONE:UNSIGNED;
TWO:UNSIGNED;
THREE:UNSIGNED;
FOUR:INTEGER;
END;
PHYSICAL_ADDRESS=PACKED RECORD
ADDRESS:UNSIGNED;
PAR_VALUE:UNSIGNED;
END;
STRUCTURE_ID=RECORD
INDEX:UNSIGNED;
SERIAL_NUMBER:LONG_INTEGER;
END;
STRUCTURE_DESC=RECORD
ID:STRUCTURE_ID;
NAME:NAME_STR;
END;
STRUCTURE_DESC_PTR=^STRUCTURE_DESC;
PROCESS_DESC=STRUCTURE_DESC;
SEMAPHORE_DESC=STRUCTURE_DESC;
QUEUE_SEMAPHORE_DESC=STRUCTURE_DESC;
RING_BUFFER_DESC=STRUCTURE_DESC;
PROCESS_STATE=(RUN,READY_ACTIVE,READY_SUSPENDED,
WAIT_ACTIVE,WAIT_SUSPENDED,
EXCEPTION_WAIT_ACTIVE,EXCEPTION_WAIT_SUSPENDED);
PROCESS_TYPE=(GENERAL,PRIVILEGED,DEV_ACCESS,DRIVER);
EXC_GROUP=0..255;
EXCEPTIONS=(MEMORY_FAULT,ILLEGAL_OPERATION,EMULATOR_TRAP,
TRAP,BREAKPOINT_TRAP,HARD_IO,SOFT_IO,NUMERIC,
RESOURCE,RANGE,EXECUTION,SYSTEM_SERVICE,
RESERVED_1,RESERVED_2,USER_1,USER_2);
EXC_SET=PACKED SET OF EXCEPTIONS;
EXC_STATUS=RECORD
EXC_TYPE:EXC_SET;
EXC_CODE:UNSIGNED;
END;
STATE_CODE_MODIFIER_TYPE=PACKED RECORD
RES1,RES2,RES3,RES4,
UNBLOCK_IN_PROGRESS,
ABORT_PENDING,
ABORTED:BOOLEAN;
END;
STATE_BLOCK=PACKED RECORD
PRIORITY:[BYTE]PRIORITY_RANGE;
STATE:[BYTE]PROCESS_STATE;
TYP:[BYTE]PROCESS_TYPE;
STATE_CODE_MODIFIER:[BYTE]STATE_CODE_MODIFIER_TYPE;
GROUP:[BYTE]EXC_GROUP;
RESERVED:[BYTE]BYTE_RANGE;
BLOCKING_SEMAPHORE:UNIVERSAL;
SUSPEND_COUNT:INTEGER;
END;
QUEUE_MESSAGE=PACKED ARRAY[1..QE_LEN]OF BYTE_RANGE;
PACKET=PACKED RECORD
LINK:UNSIGNED;
AUXILIARY:UNSIGNED;
PRIORITY:[BYTE]PRIORITY_RANGE;
CONTROL:[BYTE]BYTE_RANGE;
MESSAGE:QUEUE_MESSAGE;
END;
QUEUE_PTR=^PACKET;
INFO_BLOCK=PACKED RECORD
PRIORITY:[BYTE]PRIORITY_RANGE;
VAL_XMIT_LEN:[BYTE]VAL_DATA_LEN;
ADDRESS:PHYSICAL_ADDRESS;
REF_XMIT_LEN:[WORD]REF_DATA_LEN;
END;
ORDERING=(FIFO,PRIO);
MODE=(STREAM_MODE,RECORD_MODE);
[EXTERNAL($INPDI)]PROCEDURE INIT_PROCESS_DESC
(VAR DESC:PROCESS_DESC;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($GTSTI)]PROCEDURE GET_STATE
(VAR STATE:STATE_BLOCK;
VAR DESC:PROCESS_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($STPCI)]PROCEDURE STOP
(VAR DESC:PROCESS_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($SCHDI)]PROCEDURE SCHEDULE;EXTERNAL;
[EXTERNAL($CHGPI)]PROCEDURE CHANGE_PRIORITY
(PRIORITY:PRIORITY_RANGE;
VAR DESC:PROCESS_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($SPNDI)]FUNCTION SUSPEND
(VAR DESC:PROCESS_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($RSUMI)]FUNCTION RESUME
(VAR DESC:PROCESS_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($CRBSI)]FUNCTION CREATE_BINARY_SEMAPHORE
(WAIT_ORDER:ORDERING:=FIFO;
VALUE:BIN_SEM_VAL:=0;
VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($CRCSI)]FUNCTION CREATE_COUNTING_SEMAPHORE
(WAIT_ORDER:ORDERING:=FIFO;
VALUE:UNSIGNED:=0;
VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($SGNLI)]PROCEDURE SIGNAL
(VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($WAITI)]PROCEDURE WAIT
(VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($SGLCI)]FUNCTION COND_SIGNAL
(VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($WAICI)]FUNCTION COND_WAIT
(VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($SALLI)]PROCEDURE SIGNAL_ALL
(VAR DESC:SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($CINTI)]PROCEDURE CONNECT_INTERRUPT
(PIC:BOOLEAN;
PROCEDURE ISR;
VAR IMPURE:UNIVERSAL;
VALUE:UNSIGNED:=0;
PS:PRIORITY_RANGE;
VECTOR:UNSIGNED);EXTERNAL;
[EXTERNAL($DINTI)]PROCEDURE DISCONNECT_INTERRUPT
(VECTOR:UNSIGNED);EXTERNAL;
[EXTERNAL($CNTSI)]PROCEDURE CONNECT_SEMAPHORE
(VECTOR:UNSIGNED;
PS:PRIORITY_RANGE;
$_BP_$:INTEGER:=0;
VAR DESC:SEMAPHORE_DESC;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($DNTSI)]PROCEDURE DISCONNECT_SEMAPHORE
(VECTOR:UNSIGNED;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($CRQSI)]FUNCTION CREATE_QUEUE_SEMAPHORE
(PROCESS_ORDER:ORDERING:=FIFO;
PACKET_ORDER:ORDERING:=FIFO;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($SNDAI)]PROCEDURE SEND_ACK
(VAR REF_DATA:[READONLY]UNIVERSAL;
REF_LENGTH:REF_DATA_LEN:=0;
VAR REPLY_DESC:SEMAPHORE_DESC:=0;
$_MN_$:INTEGER:=12;
PRIORITY:PRIORITY_RANGE:=1;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($RCVAI)]PROCEDURE RECEIVE_ACK
(VAR REF_DATA:UNIVERSAL;
REF_LENGTH:REF_DATA_LEN:=0;
VAR REPLY_DESC:SEMAPHORE_DESC:=0;
$_MN_$:INTEGER:=12;
VAR REC_LENGTH:REF_DATA_LEN;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($SNACI)]FUNCTION COND_SEND_ACK
(VAR REF_DATA:[READONLY]UNIVERSAL:=0;
REF_LENGTH:REF_DATA_LEN:=0;
VAR REPLY_DESC:SEMAPHORE_DESC:=0;
$_MN_$:INTEGER:=12;
PRIORITY:PRIORITY_RANGE:=1;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($RVACI)]FUNCTION COND_RECEIVE_ACK
(VAR REF_DATA:UNIVERSAL:=0;
REF_LENGTH:REF_DATA_LEN:=0;
VAR REPLY_DESC:SEMAPHORE_DESC:=0;
$_MN_$:INTEGER:=12;
VAR REC_LENGTH:REF_DATA_LEN;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($SENDI)]PROCEDURE SEND
(VAR REF_DATA:[READONLY]UNIVERSAL:=0;
REF_LENGTH:REF_DATA_LEN:=0;
VAR VAL_DATA:[READONLY]UNIVERSAL:=0;
VAL_LENGTH:VAL_DATA_LEN:=0;
PRIORITY:PRIORITY_RANGE:=1;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($RCVDI)]PROCEDURE RECEIVE
(VAR REF_DATA:UNIVERSAL:=0;
REF_LENGTH:REF_DATA_LEN:=0;
VAR VAL_DATA:UNIVERSAL:=0;
VAL_LENGTH:VAL_DATA_LEN:=0;
VAR RET_INFO:INFO_BLOCK:=0;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($SNDCI)]FUNCTION COND_SEND
(VAR REF_DATA:[READONLY]UNIVERSAL:=0;
REF_LENGTH:REF_DATA_LEN:=0;
VAR VAL_DATA:[READONLY]UNIVERSAL:=0;
VAL_LENGTH:VAL_DATA_LEN:=0;
PRIORITY:PRIORITY_RANGE:=1;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($RCVCI)]FUNCTION COND_RECEIVE
(VAR REF_DATA:UNIVERSAL:=0;
REF_LENGTH:REF_DATA_LEN:=0;
VAR VAL_DATA:UNIVERSAL:=0;
VAL_LENGTH:VAL_DATA_LEN:=0;
VAR RET_INFO:INFO_BLOCK:=0;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($ALPKI)]PROCEDURE ALLOCATE_PACKET
(VAR PACKET_PTR:QUEUE_PTR);EXTERNAL;
[EXTERNAL($ALPCI)]FUNCTION COND_ALLOCATE_PACKET
(VAR PACKET_PTR:QUEUE_PTR):BOOLEAN;EXTERNAL;
[EXTERNAL($DAPKI)]PROCEDURE DEALLOCATE_PACKET
(PACKET_PTR:QUEUE_PTR);EXTERNAL;
[EXTERNAL($SGLQI)]PROCEDURE PUT_PACKET
(PACKET_PTR:QUEUE_PTR;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($WAIQI)]PROCEDURE GET_PACKET
(VAR PACKET_PTR:QUEUE_PTR;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($SGQCI)]FUNCTION COND_PUT_PACKET
(PACKET_PTR:QUEUE_PTR;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($WAQCI)]FUNCTION COND_GET_PACKET
(VAR PACKET_PTR:QUEUE_PTR;
VAR DESC:QUEUE_SEMAPHORE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($CRRBI)]FUNCTION CREATE_RING_BUFFER
(INPUT_MODE:MODE:=STREAM_MODE;
OUTPUT_MODE:MODE:=STREAM_MODE;
INPUT_ORDER:ORDERING:=FIFO;
OUTPUT_ORDER:ORDERING:=FIFO;
SIZE:RING_BUFFER_SIZE;
VAR DESC:RING_BUFFER_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):BOOLEAN;EXTERNAL;
[EXTERNAL($RBUFI)]PROCEDURE RESET_RING_BUFFER
(VAR DESC:RING_BUFFER_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($PELMI)]PROCEDURE PUT_ELEMENT
(LENGTH:RING_BUFFER_DATA;
VAR DATA:[READONLY]UNIVERSAL;
VAR DESC:RING_BUFFER_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($GELMI)]PROCEDURE GET_ELEMENT
(LENGTH:RING_BUFFER_DATA;
VAR DATA:UNIVERSAL;
VAR DESC:RING_BUFFER_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($PELCI)]FUNCTION COND_PUT_ELEMENT
(LENGTH:RING_BUFFER_DATA;
VAR DATA:[READONLY]UNIVERSAL;
VAR DESC:RING_BUFFER_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):INTEGER;EXTERNAL;
[EXTERNAL($GELCI)]FUNCTION COND_GET_ELEMENT
(LENGTH:RING_BUFFER_DATA;
VAR DATA:UNIVERSAL;
VAR DESC:RING_BUFFER_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0):INTEGER;EXTERNAL;
[EXTERNAL($INSDI)]PROCEDURE INIT_STRUCTURE_DESC
(VAR DESC:STRUCTURE_DESC;
VAR NAME:[READONLY]NAME_STR;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($GVALI)]PROCEDURE GET_VALUE
(VAR VALUE:INTEGER;
VAR TYP:INTEGER;
VAR DESC:STRUCTURE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
[EXTERNAL($DLSTI)]PROCEDURE DESTROY
(VAR DESC:STRUCTURE_DESC:=0;
VAR NAME:[READONLY]NAME_STR:=0;
VAR STATUS:EXC_STATUS:=0);EXTERNAL;
                                                                                                                                                                                                                   